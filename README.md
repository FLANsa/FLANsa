# ๐ช Qayd POS - ูุธุงู ุงููุงุดูุฑ ุงููุชูุงูู ูุน ZATCA

## ๐ ูุธุฑุฉ ุนุงูุฉ
ูุธุงู ููุทุฉ ุงูุจูุน (POS) ูุชูุงูู ูุน ูุชุทูุจุงุช ููุฆุฉ ุงูุฒูุงุฉ ูุงูุถุฑูุจุฉ ูุงูุฌูุงุฑู (ZATCA) ูููุฑุญูุฉ ุงูุซุงููุฉ ูู ุงูููุงุชูุฑ ุงููุจุณุทุฉ (B2C).

## โจ ุงููููุฒุงุช ุงูุฑุฆูุณูุฉ

### ๐ ูุธุงู ููุทุฉ ุงูุจูุน
- ูุงุฌูุฉ ูุณุชุฎุฏู ุนุฑุจูุฉ/ุฅูุฌููุฒูุฉ
- ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช ูุงููุฎุฒูู
- ุฏุนู ุฃููุงุน ุงูุทูุจุงุช (ูุญููุ ุณูุฑูุ ุชูุตูู)
- ุญุณุงุจ ุงูุถุฑูุจุฉ ุงููุถุงูุฉ (15%)
- ุฏุนู ุทุฑู ุงูุฏูุน ุงููุชุนุฏุฏุฉ

### ๐ ุชูุงูู ZATCA Phase-2
- ุชูููุฏ ููุงุชูุฑ UBL 2.1 ูุชูุงููุฉ
- ุชูููุน XAdES B-B ุฑููู
- ุฑููุฒ QR ูุชูุงููุฉ ูุน ZATCA
- ุฅุฏุงุฑุฉ ICV/PIH ุงููุชุณูุณูุฉ
- ุฅุฑุณุงู ุชููุงุฆู ูุจูุงุจุฉ ุงูุฅุจูุงุบ

### ๐ ุงูุฃูุงู ูุงูุญูุงูุฉ
- ุชูููุน ุงูุฎุงุฏู ููุท (Server-side signing)
- ุชุฎุฒูู ุขูู ููุดูุงุฏุงุช
- ุชุดููุฑ ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ
- ุฏุนู ูุชุนุฏุฏ ุงููุณุชุฃุฌุฑูู

## ๐ ุงูุจุฏุก ุงูุณุฑูุน

### 1. ูุชุทูุจุงุช ุงููุธุงู
```bash
Node.js >= 18.0.0
npm >= 8.0.0
Firebase CLI
OpenSSL (ูุชูููุฏ ุงูุดูุงุฏุงุช)
```

### 2. ุงูุชุซุจูุช
```bash
# ุงุณุชูุณุงุฎ ุงููุดุฑูุน
git clone https://github.com/your-repo/qayd-pos.git
cd qayd-pos

# ุชุซุจูุช ุงูุชุจุนูุงุช
npm install

# ุชุซุจูุช ุชุจุนูุงุช ุงูุฎุงุฏู
cd server
npm install
cd ..

# ุชุซุจูุช Firebase CLI
npm install -g firebase-tools
```

### 3. ุฅุนุฏุงุฏ ุงูุจูุฆุฉ
```bash
# ูุณุฎ ููู ุงูุจูุฆุฉ
cp env.zatca.example .env

# ุชุญุฏูุซ ุงูููู ูู .env
# - EGS_UNIT_ID
# - CSID_CERT_PFX_BASE64
# - CSID_CERT_PASSWORD
# - ุจูุงูุงุช ุงูููุดุฃุฉ
```

### 4. ุฅุนุฏุงุฏ Firebase
```bash
# ุชุณุฌูู ุงูุฏุฎูู ูู Firebase
firebase login

# ุชููุฆุฉ ุงููุดุฑูุน
firebase init

# ูุดุฑ ููุงุนุฏ Firestore
firebase deploy --only firestore:rules
```

### 5. ุชุดุบูู ุงููุดุฑูุน
```bash
# ุชุดุบูู ุงูุฎุงุฏู
npm run dev:server

# ุชุดุบูู ุงููุงุฌูุฉ ุงูุฃูุงููุฉ
npm run dev

# ุฃู ุชุดุบูู ููุงููุง
npm run dev:all
```

## ๐ ุฏููู ZATCA

### Onboarding
1. **ุฅูุดุงุก EGS Unit**: ุงุชุจุน [ุฏููู Onboarding](ZATCA_ONBOARDING_GUIDE.md)
2. **ุชูููุฏ CSR**: ุงุณุชุฎุฏู `./generate_csr.sh`
3. **ุทูุจ ุงูุดูุงุฏุฉ**: ูู ุจูุงุจุฉ ูุงุชูุฑุฉ ุงูุณุงูุฏุจููุณ
4. **ุชุญููู PFX**: ุงุณุชุฎุฏู `./create_pfx.sh`

### ุงูุงุฎุชุจุงุฑ
```bash
# ุงุฎุชุจุงุฑ ุงูุชูุงูู
./test_zatca.sh

# ุงุฎุชุจุงุฑ ุงููุญุฏุงุช
npm test

# ุงุฎุชุจุงุฑ E2E
npm run test:e2e
```

## ๐๏ธ ูููู ุงููุดุฑูุน

```
qayd-pos/
โโโ src/
โ   โโโ zatca/                 # ูุญุฏุงุช ZATCA
โ   โ   โโโ models.ts          # ููุงุฐุฌ ุงูุจูุงูุงุช
โ   โ   โโโ ubl.ts             # ุชูููุฏ UBL XML
โ   โ   โโโ qr.ts              # ุชูููุฏ QR codes
โ   โ   โโโ signing.ts         # ุงูุชูููุน ุงูุฑููู
โ   โ   โโโ reporting.ts       # ุฅุฑุณุงู ุงูุชูุงุฑูุฑ
โ   โ   โโโ icvPih.ts          # ุฅุฏุงุฑุฉ ICV/PIH
โ   โ   โโโ config.ts          # ุฅุนุฏุงุฏุงุช ZATCA
โ   โ   โโโ __tests__/         # ุงุฎุชุจุงุฑุงุช ุงููุญุฏุงุช
โ   โโโ pages/
โ   โ   โโโ POSEnhanced.tsx    # ููุทุฉ ุงูุจูุน
โ   โ   โโโ PrintPage.tsx      # ุตูุญุฉ ุงูุทุจุงุนุฉ
โ   โ   โโโ ...
โ   โโโ components/
โโโ server/
โ   โโโ zatca-signing.ts       # ุชูููุน ุงูุฎุงุฏู
โ   โโโ zatca.routes.ts        # ูุณุงุฑุงุช ZATCA
โ   โโโ index.ts               # ุฎุงุฏู Express
โโโ docs/                      # ุงููุซุงุฆู
โโโ tests/                     # ุงุฎุชุจุงุฑุงุช E2E
โโโ scripts/                   # ุณูุฑูุจุชุงุช ูุณุงุนุฏุฉ
```

## ๐ง ุงูุชูููู

### ูุชุบูุฑุงุช ุงูุจูุฆุฉ ุงูุฃุณุงุณูุฉ
```env
# ZATCA
ZATCA_ENV=sandbox
EGS_UNIT_ID=your_egs_unit_id
CSID_CERT_PFX_BASE64=your_base64_pfx
CSID_CERT_PASSWORD=your_password

# ุงูููุดุฃุฉ
ORG_VAT_NUMBER=300000000000003
ORG_NAME_AR=ูุทุนู ููุฏ
ORG_NAME_EN=Qayd Restaurant
```

### ุฅุนุฏุงุฏุงุช Firebase
```javascript
// firebase.json
{
  "firestore": {
    "rules": "firestore.rules",
    "indexes": "firestore.indexes.json"
  },
  "hosting": {
    "public": "dist",
    "ignore": ["firebase.json", "**/.*", "**/node_modules/**"]
  }
}
```

## ๐งช ุงูุงุฎุชุจุงุฑุงุช

### ุงุฎุชุจุงุฑุงุช ุงููุญุฏุงุช
```bash
# ุชุดุบูู ุฌููุน ุงูุงุฎุชุจุงุฑุงุช
npm test

# ุงุฎุชุจุงุฑุงุช ZATCA ููุท
npm test src/zatca

# ุงุฎุชุจุงุฑุงุช ูุน ุงูุชุบุทูุฉ
npm run test:coverage
```

### ุงุฎุชุจุงุฑุงุช ุงูุชูุงูู
```bash
# ุงุฎุชุจุงุฑ ZATCA
./test_zatca.sh

# ุงุฎุชุจุงุฑ E2E
npm run test:e2e
```

### ุงุฎุชุจุงุฑุงุช ุงูุฃุฏุงุก
```bash
# ุงุฎุชุจุงุฑ ุงูุญูู
npm run test:load

# ุงุฎุชุจุงุฑ ุงูุฐุงูุฑุฉ
npm run test:memory
```

## ๐ ุงููุฑุงูุจุฉ ูุงูุชุญููู

### ุณุฌูุงุช ุงููุธุงู
```bash
# ุนุฑุถ ุงูุณุฌูุงุช
npm run logs

# ูุฑุงูุจุฉ ZATCA
npm run logs:zatca

# ูุฑุงูุจุฉ ุงูุฃุฎุทุงุก
npm run logs:errors
```

### ููุงููุณ ุงูุฃุฏุงุก
- ููุช ุงุณุชุฌุงุจุฉ API
- ูุนุฏู ูุฌุงุญ ุงูุฅุฑุณุงู
- ุงุณุชุฎุฏุงู ุงูุฐุงูุฑุฉ
- ุงุณุชููุงู CPU

## ๐ ุงูุฃูุงู

### ุฃูุถู ุงูููุงุฑุณุงุช
1. **ุชุฎุฒูู ุงูุดูุงุฏุงุช**: ุงุณุชุฎุฏู AWS Secrets Manager ุฃู Azure Key Vault
2. **ุชุดููุฑ ุงูุจูุงูุงุช**: ุฌููุน ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ ูุดูุฑุฉ
3. **ูุฑุงูุจุฉ ุงููุตูู**: ุณุฌู ุฌููุน ุงูุนูููุงุช ุงูุญุณุงุณุฉ
4. **ุชุญุฏูุซุงุช ุงูุฃูุงู**: ุญุงูุธ ุนูู ุชุญุฏูุซ ุงูุชุจุนูุงุช

### ุชุฏููู ุงูุฃูุงู
```bash
# ูุญุต ุงูุชุจุนูุงุช
npm audit

# ูุญุต ุงูุฃูุงู ุงููุชูุฏู
npm run security:scan

# ุชุญุฏูุซ ุงูุชุจุนูุงุช
npm run security:update
```

## ๐ ุงููุดุฑ

### ุงูุจูุฆุฉ ุงูุชุทููุฑูุฉ
```bash
# ูุดุฑ Firebase
firebase deploy

# ูุดุฑ ุงูุฎุงุฏู
npm run deploy:dev
```

### ุงูุจูุฆุฉ ุงูุฅูุชุงุฌูุฉ
```bash
# ุจูุงุก ุงูุฅูุชุงุฌ
npm run build:prod

# ูุดุฑ ุงูุฅูุชุงุฌ
npm run deploy:prod

# ูุฑุงูุจุฉ ุงูุฅูุชุงุฌ
npm run monitor:prod
```

## ๐ ุงูุตูุงูุฉ

### ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ
```bash
# ูุณุฎ ุงุญุชูุงุทู ูููู
npm run backup:daily

# ูุณุฎ ุงุญุชูุงุทู ุฃุณุจูุนู
npm run backup:weekly

# ุงุณุชุนุงุฏุฉ ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ
npm run restore:backup
```

### ุชุญุฏูุซุงุช ุงููุธุงู
```bash
# ุชุญุฏูุซ ุงูุชุจุนูุงุช
npm update

# ุชุญุฏูุซ ZATCA
npm run update:zatca

# ุชุญุฏูุซ ุงููุธุงู
npm run update:system
```

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ูุดุงูู ุดุงุฆุนุฉ
1. **ุฎุทุฃ ูู ุงูุดูุงุฏุฉ**: ุชุญูู ูู ุตุญุฉ PFX ููููุฉ ุงููุฑูุฑ
2. **ูุดู ุงูุฅุฑุณุงู**: ุชุญูู ูู OTP ูSubscription Key
3. **ุฎุทุฃ ูู ICV**: ูุง ุชุนูุฏ ุถุจุท ICV ุฃุจุฏุงู
4. **ูุดุงูู ุงูุดุจูุฉ**: ุชุญูู ูู ุงูุงุชุตุงู ุจู ZATCA

### ุณุฌูุงุช ุงูุฃุฎุทุงุก
```bash
# ุนุฑุถ ุฃุฎุทุงุก ZATCA
tail -f logs/zatca-errors.log

# ุนุฑุถ ุฃุฎุทุงุก ุงููุธุงู
tail -f logs/system-errors.log

# ุนุฑุถ ุฃุฎุทุงุก ูุงุนุฏุฉ ุงูุจูุงูุงุช
tail -f logs/database-errors.log
```

## ๐ ุงูุฏุนู

### ุงููุซุงุฆู
- [ุฏููู ZATCA](ZATCA_ONBOARDING_GUIDE.md)
- [ุฏููู API](docs/API.md)
- [ุฏููู ุงููุดุฑ](docs/DEPLOYMENT.md)

### ุงูุชูุงุตู
- ุงูุจุฑูุฏ ุงูุฅููุชุฑููู: support@qayd-pos.com
- GitHub Issues: [ุฅูุดุงุก ูุดููุฉ](https://github.com/your-repo/qayd-pos/issues)
- ุงูุฏุฑุฏุดุฉ: [Discord](https://discord.gg/qayd-pos)

### ุงููุฌุชูุน
- [ููุชุฏู ุงููุทูุฑูู](https://forum.qayd-pos.com)
- [ููุงุฉ YouTube](https://youtube.com/qayd-pos)
- [ุชููุชุฑ](https://twitter.com/qayd_pos)

## ๐ ุงูุชุฑุฎูุต

ูุฐุง ุงููุดุฑูุน ูุฑุฎุต ุชุญุช ุฑุฎุตุฉ MIT. ุฑุงุฌุน ููู [LICENSE](LICENSE) ููุชูุงุตูู.

## ๐ค ุงููุณุงููุฉ

ูุฑุญุจ ุจูุณุงููุงุชูู! ุฑุงุฌุน [ุฏููู ุงููุณุงููุฉ](CONTRIBUTING.md) ููุจุฏุก.

### ููููุฉ ุงููุณุงููุฉ
1. Fork ุงููุดุฑูุน
2. ุฅูุดุงุก ูุฑุน ููููุฒุฉ ุงูุฌุฏูุฏุฉ
3. Commit ุงูุชุบููุฑุงุช
4. Push ูููุฑุน
5. ุฅูุดุงุก Pull Request

## ๐ ุงูุฅุญุตุงุฆูุงุช

- **ุงููุฌูู**: โญ 150+
- **ุงููุดุงูู**: ๐ 12 ููุชูุญุฉ
- **ุงููุณุงููุงุช**: ๐ฅ 25+ ูุทูุฑ
- **ุงูุฅุตุฏุงุฑ**: ๐ฆ v1.0.0

## ๐ฏ ุงูุทุฑูู ุงููุณุชูุจูู

### ุงูููุฒุงุช ุงููุงุฏูุฉ
- [ ] ุฏุนู ุงูููุงุชูุฑ ุงููุนูุฏุฉ (B2B)
- [ ] ุชูุงูู ูุน ุฃูุธูุฉ ุงููุญุงุณุจุฉ
- [ ] ุชุทุจูู ุฌูุงู
- [ ] ุชุญูููุงุช ูุชูุฏูุฉ
- [ ] ุฏุนู ุงูุนููุงุช ุงููุชุนุฏุฏุฉ

### ุงูุชุญุณููุงุช ุงููุฎุทุทุฉ
- [ ] ุชุญุณูู ุงูุฃุฏุงุก
- [ ] ูุงุฌูุฉ ูุณุชุฎุฏู ูุญุณูุฉ
- [ ] ุฏุนู ุงููุบุงุช ุงูุฅุถุงููุฉ
- [ ] ุชูุงูู ูุน ุฃูุธูุฉ ุงูุฏูุน

---

**ุชู ุชุทููุฑู ุจู โค๏ธ ูู ุงูููููุฉ ุงูุนุฑุจูุฉ ุงูุณุนูุฏูุฉ**

